%! Author = e4
%! Date = 3/3/24

% Preamble
\documentclass{article}

% Packages
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{float}
\usepackage{amsmath}
\usepackage{tabularray}
\usepackage{pdflscape}
\usepackage{xcolor}
\usepackage{times} % This package sets Times New Roman as the default text font
\usepackage{helvet} % This package is for Helvetica, a sans-serif font
\usepackage{courier} % This package is for Courier, a monospaced font
\geometry{
    a4paper,
    total={170mm,257mm},
    left=20mm,
    top=20mm,
}

\renewcommand{\familydefault}{\sfdefault} % Set the default font to sans-serif (Helvetica)

\title{\fontsize{16pt}{19pt}\selectfont\textbf{Forensic Report on Network Intrusion}}
\author{\fontsize{12pt}{14pt}\selectfont [Your Name] \\ Bank of Hong Kong}
\date{\fontsize{12pt}{14pt}\selectfont [Date of the Report]}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=cyan,
}

% Listings package configuration
\lstset{
    language=Python, % Setting the language
    basicstyle=\ttfamily\small, % Code font style
    keywordstyle=\color{blue}, % Keyword style
    stringstyle=\color{red}, % String literal style
    commentstyle=\color{green}, % Comment style
    morecomment=[l][\color{magenta}]{\#}, % Specifying comment style
    frame=single, % Adding a frame around the code
    backgroundcolor=\color{gray!10}, % Background color for the code block
    showspaces=false, % Show spaces adding particular underscores
    showstringspaces=false, % Underline spaces within strings only
    showtabs=false, % Show tabs within strings adding particular underscores
    tabsize=2, % Sets default tabsize to 2 spaces
    captionpos=b, % Sets the caption-position to bottom
    breaklines=true, % Sets automatic line breaking
    breakatwhitespace=false, % Sets if automatic breaks should only happen at whitespace
}

% Document
\begin{document}

    \maketitle

    \section{\fontsize{14pt}{17pt}\selectfont Overview / Case Summary}\label{sec:selectfont-overview-/-case-summary}
    On the 29th of October 2022, at approximately 3:00 p.m.,
    the Intrusion Detection System (IDS) of the Bank of Hong Kong flagged abnormal network activities aimed at the Bank's web server.
    This prompted an immediate and thorough examination,
    leading to the suspicion of a deliberate cyber-attack.
    As the appointed network security engineer, my task was to investigate these anomalies,
    analyze network traffic, and reconstruct the whole attack.

    \section{\fontsize{14pt}{17pt}\selectfont Objective/Tools Used/Evidence Map \& Table}\label{sec:selectfont-objective/tools-used/evidence-map-&-table}
    The primary objective of this forensic investigation is to analyze the pcap file to identify suspicious activities
    and reconstruct the events that occurred during the attack.
    Tools used for this analysis include Wireshark for packet inspection.
    The Evidence Map \& Table, provided as follows, organizes the evidence collected during the investigation.

    \begin{landscape}
        \begin{longtblr}[
            caption = {Evidence Table (Private IP Addresses)},
            label = {tab:evidence-table-under-private-range},
        ]{
            colspec = {Q[l, 3cm] X[l] X[l] X[l] Q[l, 2cm] X[l, -1]},
            row{1} = {2em,azure7,fg=white,font=\large},
            hlines, vlines,
        }
            IP Address & Host Name & Function & Digital Evidence & Type & Priority \\
            \lstinline{192.168.56.1} or \lstinline{147.8.178.172} & ATHENA & Server Type: 0x00011007 (Workstation, Server, SQL, NT Workstation, Potential Browser) & Keep getting ICMP request from \lstinline{192.168.93.131} & Windows XP (5.1) &  \\
            \lstinline{192.168.93.1} & -- & Participating in Dropbox's LAN sync feature & Search for media renderer and media server & -- & \\
            \lstinline{192.168.93.2} & -- & Router/DNS/NBNS & -- & -- & \\
            \lstinline{192.168.93.131} & WIN-0GR9LTN6K0J.localdomain & (Workstation/Redirector) & Keep sending ICMP request to \lstinline{192.168.56.1} & MSFT 5.0 (maybe .NET 5.0 compatible) & \\
            \lstinline{192.168.93.254} & localdomain (domain name) & DHCP Server & -- & -- & \\
            \lstinline{192.168.93.255} & -- & Broadcast & -- & -- & \\
            \lstinline{192.168.240.11} & SHRN100CB310 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.12} & SHRN100LG103 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.13} & SHRN100HW305 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.14} & SHRN100HW307 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.15} & SHRN100HW308 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.16} & SHRN100HW310 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.17} & SHRN100HW311 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.19} & SHRN100HW335A & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.20} & SHRN100HW335 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.21} & SHRN100CPLG104 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.22} & SHRN100HW327 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.23} & SHRN100CB315 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.24} & SHRN100LG101 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.25} & SHRN100LG102 & iGuard Security System Slave & Send heartbeat or status update every 30 seconds to Master (through broadcast) & -- & \\
            \lstinline{192.168.240.253} & INTRALINK (Master Browser Server Name) & iGuard Security System Master / Local Master Browser within subnet \lstinline{192.168.240.0/24} (Machine Group: CSISAD) Server Type: 0x00849a03, Workstation, Server, Print, Xenix, NT Workstation, NT Server, Master Browser, DFS & -- & Windows Millenium Edition (Windows NT 4.9) & \\
            \lstinline{192.168.240.255} & -- & Broadcast & -- & -- & \\
        \end{longtblr}
    \end{landscape}

    \section{\fontsize{14pt}{17pt}\selectfont Investigation on Attack}\label{sec:selectfont-investigation-on-attack}
    \subsection{Hosts List}\label{subsec:hosts-list}
    The analysis of the pcap file revealed several hosts with a substantial amount of network traffic,
    constituting more than 1\% of the captured packets.
    The details of these hosts, including IP and MAC addresses, are tabulated in Appendix A.

    \subsection{Victim Information}\label{subsec:victim-information}
    The victim of the attack was identified as the Bank's web server.
    Detailed information regarding the server's IP address, MAC address, and other relevant details are included in Appendix B.

    \subsection{Attacker Information}\label{subsec:attacker-information}
    Through careful inspection of the network traffic, the attacker's identity was deduced.
    The corresponding IP and MAC addresses, as well as the techniques used in the intrusion, are documented in Appendix C.

    \subsection{Description of Attacks}\label{subsec:description-of-attacks}
    The attack methodologies observed from the packet captures indicated a structured and multi-phased approach,
    including reconnaissance, exploitation, and data exfiltration attempts.
    Specific attack vectors and their signatures are outlined in Appendix D.


    \section{\fontsize{14pt}{17pt}\selectfont Investigative Reconstruction}\label{sec:selectfont-investigative-reconstruction}
    Upon scrutinizing the sequence of network events, a timeline of the attack was reconstructed,
    revealing the methods and progression of the malicious activities.
    This reconstruction is crucial for understanding the attack's impact and for developing future mitigation strategies.

    \section{\fontsize{14pt}{17pt}\selectfont Appendix: Evidence Hash and Basic Information}\label{sec:selectfont-appendix:-evidence-hash-and-basic-information}
    Each piece of digital evidence has been hashed to ensure integrity and authenticity.
    The hashes, alongside basic information such as file names, sizes, and timestamps, are provided in Appendix E.

\end{document}